import{_ as T,E as $,ad as V,b as F,d as B,af as G,N as S,aB as A,a2 as I,k as O,V as j,o as h,c as z,f as e,w as a,W as P,e as v,g as _,C as U,J as q,l as u,m as H,q as J,a4 as L,a5 as M}from"./index.24f9f7c9.js";/* empty css                        *//* empty css                      *//* empty css                  *//* empty css                  *//* empty css                *//* empty css                */import W from"./save.2729fac8.js";const K={name:"user",components:{saveDialog:W},data(){return{dialog:{save:!1},showGrouploading:!1,groupFilterText:"",group:[],apiObj:this.$API.system.user.list,selection:[],search:{name:null}}},watch:{groupFilterText(t){this.$refs.group.filter(t)}},mounted(){this.getGroup()},methods:{add(){this.dialog.save=!0,this.$nextTick(()=>{this.$refs.saveDialog.open()})},table_edit(t){this.dialog.save=!0,this.$nextTick(()=>{this.$refs.saveDialog.open("edit").setData(t)})},table_show(t){this.dialog.save=!0,this.$nextTick(()=>{this.$refs.saveDialog.open("show").setData(t)})},async table_del(t,l){var n={id:t.id},d=await this.$API.demo.post.post(n);d.code==200?(this.$refs.table.tableData.splice(l,1),this.$message.success("\u5220\u9664\u6210\u529F")):this.$alert(d.message,"\u63D0\u793A",{type:"error"})},async batch_del(){this.$confirm(`\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684 ${this.selection.length} \u9879\u5417\uFF1F`,"\u63D0\u793A",{type:"warning"}).then(()=>{const t=this.$loading();this.selection.forEach(l=>{this.$refs.table.tableData.forEach((n,d)=>{l.id===n.id&&this.$refs.table.tableData.splice(d,1)})}),t.close(),this.$message.success("\u64CD\u4F5C\u6210\u529F")}).catch(()=>{})},selectionChange(t){this.selection=t},async getGroup(){this.showGrouploading=!0;var t=await this.$API.system.dept.list.get();this.showGrouploading=!1;var l={id:"",label:"\u6240\u6709"};t.data.unshift(l),this.group=t.data},groupFilterNode(t,l){return t?l.label.indexOf(t)!==-1:!0},groupClick(t){var l={groupId:t.id};this.$refs.table.reload(l)},upsearch(){this.$refs.table.upData(this.search)},handleSuccess(t,l){l=="add"?(t.id=new Date().getTime(),this.$refs.table.tableData.unshift(t)):l=="edit"&&this.$refs.table.tableData.filter(n=>n.id===t.id).forEach(n=>{Object.assign(n,t)})}}},Q={class:"left-panel"},R=u("\u5206\u914D\u89D2\u8272"),X=u("\u5BC6\u7801\u91CD\u7F6E"),Y={class:"right-panel"},Z={class:"right-panel-search"},ee=u("\u67E5\u770B"),te=u("\u7F16\u8F91"),le=u("\u5220\u9664");function ae(t,l,n,d,o,i){const m=H,f=$,w=V,g=F,p=B,y=G,r=J,c=S,k=A,x=I,C=L,D=M,E=O("save-dialog"),N=j;return h(),z(q,null,[e(p,null,{default:a(()=>[P((h(),v(y,{width:"200px"},{default:a(()=>[e(p,null,{default:a(()=>[e(f,null,{default:a(()=>[e(m,{placeholder:"\u8F93\u5165\u5173\u952E\u5B57\u8FDB\u884C\u8FC7\u6EE4",modelValue:o.groupFilterText,"onUpdate:modelValue":l[0]||(l[0]=s=>o.groupFilterText=s),clearable:""},null,8,["modelValue"])]),_:1}),e(g,{class:"nopadding"},{default:a(()=>[e(w,{ref:"group",class:"menu","node-key":"id",data:o.group,"current-node-key":"","highlight-current":!0,"expand-on-click-node":!1,"filter-node-method":i.groupFilterNode,onNodeClick:i.groupClick},null,8,["data","filter-node-method","onNodeClick"])]),_:1})]),_:1})]),_:1})),[[N,o.showGrouploading]]),e(p,null,{default:a(()=>[e(f,null,{default:a(()=>[_("div",Q,[e(r,{type:"primary",icon:"el-icon-plus",onClick:i.add},null,8,["onClick"]),e(r,{type:"danger",plain:"",icon:"el-icon-delete",disabled:o.selection.length==0,onClick:i.batch_del},null,8,["disabled","onClick"]),e(r,{type:"primary",plain:"",disabled:o.selection.length==0},{default:a(()=>[R]),_:1},8,["disabled"]),e(r,{type:"primary",plain:"",disabled:o.selection.length==0},{default:a(()=>[X]),_:1},8,["disabled"])]),_("div",Y,[_("div",Z,[e(m,{modelValue:o.search.name,"onUpdate:modelValue":l[1]||(l[1]=s=>o.search.name=s),placeholder:"\u767B\u5F55\u8D26\u53F7 / \u59D3\u540D",clearable:""},null,8,["modelValue"]),e(r,{type:"primary",icon:"el-icon-search",onClick:i.upsearch},null,8,["onClick"])])])]),_:1}),e(g,{class:"nopadding"},{default:a(()=>[e(D,{ref:"table",apiObj:o.apiObj,onSelectionChange:i.selectionChange,stripe:"",remoteSort:"",remoteFilter:""},{default:a(()=>[e(c,{type:"selection",width:"50"}),e(c,{label:"ID",prop:"id",width:"80",sortable:"custom"}),e(c,{label:"\u5934\u50CF",width:"80","column-key":"filterAvatar",filters:[{text:"\u5DF2\u4E0A\u4F20",value:"1"},{text:"\u672A\u4E0A\u4F20",value:"0"}]},{default:a(s=>[e(k,{src:s.row.avatar,size:"small"},null,8,["src"])]),_:1}),e(c,{label:"\u767B\u5F55\u8D26\u53F7",prop:"userName",width:"150",sortable:"custom","column-key":"filterUserName",filters:[{text:"\u7CFB\u7EDF\u8D26\u53F7",value:"1"},{text:"\u666E\u901A\u8D26\u53F7",value:"0"}]}),e(c,{label:"\u59D3\u540D",prop:"name",width:"150",sortable:"custom"}),e(c,{label:"\u6240\u5C5E\u89D2\u8272",prop:"groupName",width:"200",sortable:"custom"}),e(c,{label:"\u52A0\u5165\u65F6\u95F4",prop:"date",width:"170",sortable:"custom"}),e(c,{label:"\u64CD\u4F5C",fixed:"right",align:"right",width:"160"},{default:a(s=>[e(C,null,{default:a(()=>[e(r,{text:"",type:"primary",size:"small",onClick:b=>i.table_show(s.row,s.$index)},{default:a(()=>[ee]),_:2},1032,["onClick"]),e(r,{text:"",type:"primary",size:"small",onClick:b=>i.table_edit(s.row,s.$index)},{default:a(()=>[te]),_:2},1032,["onClick"]),e(x,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:b=>i.table_del(s.row,s.$index)},{reference:a(()=>[e(r,{text:"",type:"primary",size:"small"},{default:a(()=>[le]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:1})]),_:1},8,["apiObj","onSelectionChange"])]),_:1})]),_:1})]),_:1}),o.dialog.save?(h(),v(E,{key:0,ref:"saveDialog",onSuccess:i.handleSuccess,onClosed:l[2]||(l[2]=s=>o.dialog.save=!1)},null,8,["onSuccess"])):U("",!0)],64)}const pe=T(K,[["render",ae]]);export{pe as default};
