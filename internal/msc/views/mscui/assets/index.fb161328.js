import{_ as D,E as N,Q as E,a3 as M,K as b,a4 as I,S as T,a5 as F,r as B,D as A,o as p,c as _,w as l,G as L,d as a,m as u,t as P,a6 as V,ah as z,A as K,f as S}from"./index.d39b14b4.js";/* empty css                  *//* empty css                *//* empty css                */import q from"./save.3a13819b.js";/* empty css                    */let G=1;const H={name:"settingMenu",components:{save:q},data(){return{menuloading:!1,menuList:[],menuProps:{label:e=>e.meta.title},menuFilterText:""}},watch:{menuFilterText(e){this.$refs.menu.filter(e)}},mounted(){this.getMenu()},methods:{async getMenu(){this.menuloading=!0;var e=await this.$API.system.menu.list.get();this.menuloading=!1,this.menuList=e.data},menuClick(e,t){var s=t.level==1?void 0:t.parent.data.id;this.$refs.save.setData(e,s),this.$refs.main.$el.scrollTop=0},menuFilterNode(e,t){if(!e)return!0;var s=t.meta.title;return s.indexOf(e)!==-1},nodeDrop(e,t,s){this.$refs.save.setData({}),this.$message(`\u62D6\u62FD\u5BF9\u8C61\uFF1A${e.data.meta.title}, \u91CA\u653E\u5BF9\u8C61\uFF1A${t.data.meta.title}, \u91CA\u653E\u5BF9\u8C61\u7684\u4F4D\u7F6E\uFF1A${s}`)},async add(e,t){var s="\u672A\u547D\u540D"+G++,i={parentId:t?t.id:"",name:s,path:"",component:"",meta:{title:s,type:"menu"}};this.menuloading=!0;var n=await this.$API.demo.post.post(i);this.menuloading=!1,i.id=n.data,this.$refs.menu.append(i,e),this.$refs.menu.setCurrentKey(i.id);var o=e?e.data.id:"";this.$refs.save.setData(i,o)},async delMenu(){var e=this.$refs.menu.getCheckedNodes();if(e.length==0)return this.$message.warning("\u8BF7\u9009\u62E9\u9700\u8981\u5220\u9664\u7684\u9879"),!1;var t=await this.$confirm("\u786E\u8BA4\u5220\u9664\u5DF2\u9009\u62E9\u7684\u83DC\u5355\u5417\uFF1F","\u63D0\u793A",{type:"warning",confirmButtonText:"\u5220\u9664",confirmButtonClass:"el-button--danger"}).catch(()=>{});if(t!="confirm")return!1;this.menuloading=!0;var s={ids:e.map(n=>n.id)},i=await this.$API.demo.post.post(s);this.menuloading=!1,i.code==200?e.forEach(n=>{var o=this.$refs.menu.getNode(n);o.isCurrent&&this.$refs.save.setData({}),this.$refs.menu.remove(n)}):this.$message.warning(i.message)}}},O={class:"custom-tree-node el-tree-node__label"},Q={class:"label"},U={class:"do"};function j(e,t,s,i,n,o){const f=N,h=E,g=z,v=K,x=M,m=b,c=S,k=I,d=T,w=F,y=B("save"),C=A;return p(),_(d,null,{default:l(()=>[L((p(),_(w,{width:"300px"},{default:l(()=>[a(d,null,{default:l(()=>[a(h,null,{default:l(()=>[a(f,{placeholder:"\u8F93\u5165\u5173\u952E\u5B57\u8FDB\u884C\u8FC7\u6EE4",modelValue:n.menuFilterText,"onUpdate:modelValue":t[0]||(t[0]=r=>n.menuFilterText=r),clearable:""},null,8,["modelValue"])]),_:1}),a(m,{class:"nopadding"},{default:l(()=>[a(x,{ref:"menu",class:"menu","node-key":"id",data:n.menuList,props:n.menuProps,draggable:"","highlight-current":"","expand-on-click-node":!1,"check-strictly":"","show-checkbox":"","filter-node-method":o.menuFilterNode,onNodeClick:o.menuClick,onNodeDrop:o.nodeDrop},{default:l(({node:r,data:$})=>[u("span",O,[u("span",Q,P(r.label),1),u("span",U,[a(v,{onClick:V(J=>o.add(r,$),["stop"])},{default:l(()=>[a(g)]),_:2},1032,["onClick"])])])]),_:1},8,["data","props","filter-node-method","onNodeClick","onNodeDrop"])]),_:1}),a(k,{style:{height:"51px"}},{default:l(()=>[a(c,{type:"primary",size:"small",icon:"el-icon-plus",onClick:t[1]||(t[1]=r=>o.add())}),a(c,{type:"danger",size:"small",plain:"",icon:"el-icon-delete",onClick:o.delMenu},null,8,["onClick"])]),_:1})]),_:1})]),_:1})),[[C,n.menuloading]]),a(d,null,{default:l(()=>[a(m,{class:"nopadding",style:{padding:"20px"},ref:"main"},{default:l(()=>[a(y,{ref:"save",menu:n.menuList},null,8,["menu"])]),_:1},512)]),_:1})]),_:1})}const te=D(H,[["render",j],["__scopeId","data-v-1c91a54f"]]);export{te as default};
