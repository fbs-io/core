import{_ as p,E as c,a as f,b as g,o as h,c as _,w as l,d as r,e as w,t as E,f as O}from"./index.d39b14b4.js";const $={data(){return{form:{user:"",password:"",autologin:!0},rules:{user:[{required:!0,message:this.$t("login.userError"),trigger:"blur"}],password:[{required:!0,message:this.$t("login.PWError"),trigger:"blur"}]},islogin:!1}},watch:{},mounted(){},methods:{async login(){var t=await this.$refs.loginForm.validate().catch(()=>{});if(!t)return!1;this.islogin=!0;var o={username:this.form.user,password:this.form.password},e=await this.$API.auth.token.post(o);if(e.errno==0){if(this.$TOOL.cookie.set("TOKEN",e.details.token,{expires:this.form.autologin?30*60:0}),this.$TOOL.data.set("USER_INFO",e.details.userInfo),e.details.menu.length==0)return this.islogin=!1,this.$alert("\u5F53\u524D\u7528\u6237\u65E0\u4EFB\u4F55\u83DC\u5355\u6743\u9650\uFF0C\u8BF7\u8054\u7CFB\u7CFB\u7EDF\u7BA1\u7406\u5458","\u65E0\u6743\u9650\u8BBF\u95EE",{type:"error",center:!0}),!1;this.$TOOL.data.set("MENU",e.details.menu),this.$TOOL.data.set("PERMISSIONS",e.details.permissions)}else return this.islogin=!1,this.$message.warning(e.message),!1;this.$router.replace({path:"/",components:"overview"}),this.$message.success("Login Success \u767B\u5F55\u6210\u529F"),this.islogin=!1}}};function k(t,o,e,I,s,u){const n=c,a=f,d=O,m=g;return h(),_(m,{ref:"loginForm",model:s.form,rules:s.rules,"label-width":"0",size:"large"},{default:l(()=>[r(a,{prop:"user"},{default:l(()=>[r(n,{modelValue:s.form.user,"onUpdate:modelValue":o[0]||(o[0]=i=>s.form.user=i),"prefix-icon":"el-icon-user",clearable:"",placeholder:t.$t("login.userPlaceholder")},null,8,["modelValue","placeholder"])]),_:1}),r(a,{prop:"password"},{default:l(()=>[r(n,{modelValue:s.form.password,"onUpdate:modelValue":o[1]||(o[1]=i=>s.form.password=i),"prefix-icon":"el-icon-lock",clearable:"","show-password":"",placeholder:t.$t("login.PWPlaceholder")},null,8,["modelValue","placeholder"])]),_:1}),r(a,null,{default:l(()=>[r(d,{type:"primary",style:{width:"100%"},loading:s.islogin,round:"",onClick:u.login},{default:l(()=>[w(E(t.$t("login.signIn")),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model","rules"])}const b=p($,[["render",k]]);export{b as default};
